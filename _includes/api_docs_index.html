<div class="box">
  <h4>API Reference</h4>
  <div id="api-search-container" class="clearfix">
    <input type="text" class="api-search-input input-text" placeholder="Search...">
    <ul id="api-search-results"></ul>
  </div>
  <ul>
    {% for doc in site.api_index %}
    <li class="{% if page.title == doc.title %}current{% endif %}">
      <a href="{{ site.url }}/docs/api/{{ doc.id }}.html">{{ doc.title }}</a>
    </li>
    {% endfor %}
  </ul>
</div>

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>

<script>
  $(function() {
    var index = [];

    $.getJSON('/docs/api/search.json', function(data) {
      index = data;
    });

    $('.api-search-input').keyup(function(e) {
      var query = $(this).val();
      $('#api-search-results').empty();

      if (!query) return

      var results = index.filter(function(item) {
        if (item != null && typeof(item) !== 'undefined' && item.name.indexOf)
          return item.name.toLowerCase().indexOf(query.toLowerCase()) !== -1;
        else
          return false
      });

      results = results.slice(0, 7);

      results.forEach(function(result) {
        var content = $('<a>').attr('href', result.link).html(result.name);
        $('<li>').html(content).appendTo('#api-search-results');
      });
    });

  });
</script>
