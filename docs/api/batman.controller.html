---
layout: api_docs
title: Batman.Controller
sub: 
  - title: Controller Directory
    tokens: []
    id: controller_directory
    html: "<p><code>Batman.Controller</code>s are singletons which means each controller in your application is instantiated exactly once. The instance of each controller is available on the class at the <code>@sharedController</code> property, or within a <code>ControllerDirectory</code> on the <code>Application</code> class. See <code>Batman.Application.controllers</code>.</p>\n"
  - title: Actions
    tokens: []
    id: actions
    html: "<p>Each <code>Batman.Controller</code> should have a number of instance level functions which can fetch the data needed and often render a view (or views) to display that data. These functions can be declared in typical CoffeeScript fashion like so:</p>\n<pre><code class=\"lang-example\">  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Alfred</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">App</span></span>\n    <span class=\"property\">@root</span> <span class=\"string\">\"todos#index\"</span>\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Alfred</span>.<span class=\"title\">TodosController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    index: (params) -&gt;\n    show: (params) -&gt;</code></pre>\n<p>Each action function receives the parameters from the dispatcher which are pulled out of the navigated-to URL. This includes both named route parameters (<code>/:foo</code> style) as well as arbitrary query parameters (<code>?foo=bar</code> style).</p>\n"
  - title: routingKey and Minification
    tokens: []
    id: routingkey_and_minification
    html: "<p>For functionality like contextual redirects and automatic view source and class inference, Batman needs to know the name of all your <code>Controller</code> subclasses. The usual way to do this is by using <code>Function::name</code> which Batman will use in development, but this is often mangled in minified production environments. For this reason, Batman will error out on boot if a <code>Controller</code> subclass&#39; <code>routingKey</code> is not defined on the prototype. The <code>routingKey</code> is a <code>String</code> which remains unmangled after minification and thus allows Batman to continue using the aforementioned features. To disable this requirement (if you know your code won&#39;t ever be minified), set <code>Batman.config.minificationErrors</code> to false.</p>\n"
  - title: render
    tokens: []
    meta: 
      type: function
      level: prototype
      params: "[options : [Object|boolean]]"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: prototype_function_render
    html: "<p><code>render</code> is used to control the rendering of the currently executed action. Passing <code>false</code> will prevent the current action from implicitly rendering the view. Passing an <code>options</code> object allows the default <code>view</code>, <code>source</code>, <code>viewClass</code> or <code>yield</code> block to be overridden, all of which are optional. If no parameters are passed to options, it will manually trigger the render function, rather than waiting for it to be implicitly called at the end of the action.</p>\n<p><em>Note</em>: For more information on yield blocks, see Controller::.defaultRenderYield</p>\n<pre><code><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n  routingKey: <span class=\"string\">'test'</span>\n\n  nonVisibleAction: -&gt;\n    <span class=\"property\">@render</span>(<span class=\"literal\">false</span>)\n\n  customSource: -&gt;\n    <span class=\"property\">@render</span>(source: <span class=\"string\">'errors/404'</span>)\n\n  customYield: -&gt;\n    <span class=\"property\">@render</span>(into: <span class=\"string\">'not-main'</span>)\n\n  delayedRender: -&gt;\n    setTimeout (-&gt; <span class=\"property\">@render</span>()), <span class=\"number\">1000</span>\n    <span class=\"property\">@render</span>(<span class=\"literal\">false</span>)</code></pre>\n"
  - title: beforeAction
    tokens: []
    meta: 
      type: function
      level: class
      params: "[options : [string|Object],] filter : [string|Function]"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: class_function_beforeaction
    html: "<p><code>@beforeAction</code> allows controllers to declare that a function should be executed before the body of an action during action execution. <code>@beforeAction</code> optionally accepts some options representing which action(s) to execute the filter before, and then a string naming a function or function proper to execute.</p>\n<p>The <code>options</code> argument can take three forms to imply different things:</p>\n<ol>\n<li><code>undefined</code>: implies that this filter function should be executed before all actions.</li>\n<li>a String: implies that this filter function should be executed before the action named by the string.</li>\n<li>an Object: implies that this filter function should be executed before the actions named by an Array at the <code>only</code> key in the options object, or before all actions excluding those named by an Array at the <code>except</code> key in the options object.</li>\n</ol>\n<pre><code>test <span class=\"string\">\"@beforeAction allows declaration of filters to execute before an action\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@beforeAction</span> only: <span class=\"string\">\"index\"</span>, -&gt; results.push <span class=\"string\">\"before!\"</span>\n    index: -&gt;\n      results.push <span class=\"string\">\"action!\"</span>\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"index\"</span>\n  equal results[<span class=\"number\">0</span>], <span class=\"string\">\"before!\"</span>\n  equal results[<span class=\"number\">1</span>], <span class=\"string\">\"action!\"</span>\n\ntest <span class=\"string\">\"@beforeAction allows declaration of named filters to execute before an action\"</span>, -&gt;\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@beforeAction</span> only: <span class=\"string\">\"show\"</span>, <span class=\"string\">\"fetchTodo\"</span>\n    fetchTodo: -&gt; <span class=\"property\">@set</span>(<span class=\"string\">\"todo\"</span>, {isDone: <span class=\"literal\">true</span>})\n    show: -&gt;\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TodoController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"show\"</span>\n  deepEqual controller.get(<span class=\"string\">\"todo\"</span>), {isDone: <span class=\"literal\">true</span>}\n\ntest <span class=\"string\">\"@beforeAction allows whitelisting or blacklisting filters to execute before an action\"</span>, -&gt;\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@beforeAction</span> only: [<span class=\"string\">\"show\"</span>, <span class=\"string\">\"edit\"</span>], <span class=\"string\">\"fetchTodo\"</span>\n    <span class=\"property\">@beforeAction</span> except: [<span class=\"string\">\"index\"</span>], <span class=\"string\">\"prepareNewTodo\"</span>\n    fetchTodo: -&gt; <span class=\"property\">@set</span> <span class=\"string\">\"todo\"</span>, {isDone: <span class=\"literal\">true</span>}\n    prepareNewTodo: -&gt; <span class=\"property\">@set</span> <span class=\"string\">\"newTodo\"</span>, {isDone: <span class=\"literal\">false</span>}\n    index: -&gt; <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n    show: -&gt; <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TodoController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"show\"</span>\n  deepEqual controller.get(<span class=\"string\">\"todo\"</span>), {isDone: <span class=\"literal\">true</span>}\n  deepEqual controller.get(<span class=\"string\">\"newTodo\"</span>), {isDone: <span class=\"literal\">false</span>}\n\ntest <span class=\"string\">\"@beforeAction allows declaration of filters to execute before all actions\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@beforeAction</span> -&gt; results.push <span class=\"string\">\"before!\"</span>\n    index: -&gt;\n      results.push <span class=\"string\">\"action!\"</span>\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"index\"</span>\n  equal results[<span class=\"number\">0</span>], <span class=\"string\">\"before!\"</span>\n  equal results[<span class=\"number\">1</span>], <span class=\"string\">\"action!\"</span></code></pre>\n"
  - title: afterAction
    tokens: []
    meta: 
      type: function
      level: class
      params: "[options : [string|Object],] filter : [string|Function]"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: class_function_afteraction
    html: "<p><code>@afterAction</code> allows controllers to declare that a function should be run after the action body and all operations have completed during action execution. Functions declared by <code>@afterAction</code> will thus be run after the code of the action body and also after any redirects or renders have taken place and completed. <code>@afterAction</code> optionally accepts some options representing which action(s) to execute the filter after, and then a string naming a function or function proper to execute. See <code>Batman.Controller.beforeAction</code> for documentation on the structure of the options.</p>\n<pre><code>test <span class=\"string\">\"@afterAction allows declaration of filters to execute after an action\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@afterAction</span> only: <span class=\"string\">\"index\"</span>, -&gt; results.push <span class=\"string\">\"after!\"</span>\n    index: -&gt;\n      results.push <span class=\"string\">\"action!\"</span>\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"index\"</span>\n  equal results[<span class=\"number\">0</span>], <span class=\"string\">\"action!\"</span>\n  equal results[<span class=\"number\">1</span>], <span class=\"string\">\"after!\"</span>\n\ntest <span class=\"string\">\"@afterAction allows declaration of named filters to execute after an action\"</span>, -&gt;\n  result = <span class=\"literal\">null</span>\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@afterAction</span> only: <span class=\"string\">\"create\"</span>, <span class=\"string\">\"notify\"</span>\n    notify: -&gt; result = <span class=\"string\">\"Todo created successfully.\"</span>\n    create: -&gt; <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TodoController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"create\"</span>\n  equal result, <span class=\"string\">\"Todo created successfully.\"</span>\n\ntest <span class=\"string\">\"@afterAction allows whitelisting or blacklisting filters to execute after an action\"</span>, -&gt;\n  result = <span class=\"literal\">null</span>\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@afterAction</span> only: [<span class=\"string\">\"create\"</span>, <span class=\"string\">\"update\"</span>], <span class=\"string\">\"notify\"</span>\n    index: -&gt; <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n    create: -&gt; <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n    notify: -&gt; result = <span class=\"string\">\"Todo created successfully.\"</span>\n\n  controller = TodoController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"index\"</span>\n  equal result, <span class=\"literal\">null</span>\n  controller.dispatch <span class=\"string\">\"create\"</span>\n  equal result, <span class=\"string\">\"Todo created successfully.\"</span>\n\ntest <span class=\"string\">\"@afterAction allows declaration of filters to execute after all actions\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@afterAction</span> -&gt; results.push <span class=\"string\">\"after!\"</span>\n    index: -&gt;\n      results.push <span class=\"string\">\"action!\"</span>\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"index\"</span>\n  equal results[<span class=\"number\">0</span>], <span class=\"string\">\"action!\"</span>\n  equal results[<span class=\"number\">1</span>], <span class=\"string\">\"after!\"</span></code></pre>\n"
  - title: executeAction
    tokens: []
    meta: 
      type: function
      level: prototype
      params: "action: string[, params: Object]"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: prototype_function_executeaction
    html: "<p><code>executeAction</code> will run the <code>action</code> specified, running all <code>@beforeAction</code> and <code>@afterAction</code> filters that match that endpoint. Optionally, <code>params</code> can be passed into the new action for processing. If no params are passed, it will default to the params of the current action.</p>\n<pre><code>test <span class=\"string\">\"executeAction will run the called action\"</span>, -&gt;\n  result = <span class=\"literal\">null</span>\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    show: (params) -&gt;\n      result = params.id\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n    other: -&gt;\n      <span class=\"property\">@executeAction</span>(<span class=\"string\">\"show\"</span>, {id: <span class=\"number\">4</span>})\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"other\"</span>\n  equal result, <span class=\"number\">4</span>\n\ntest <span class=\"string\">\"executeAction will run all @beforeAction and @afterAction filters\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span></span>\n    routingKey: <span class=\"string\">\"test\"</span>\n    <span class=\"property\">@beforeAction</span> only: <span class=\"string\">\"index\"</span>, -&gt; results.push <span class=\"string\">\"before!\"</span>\n    <span class=\"property\">@afterAction</span> only: <span class=\"string\">\"index\"</span>, -&gt; results.push <span class=\"string\">\"after!\"</span>\n    index: -&gt;\n      results.push <span class=\"string\">\"action!\"</span>\n      <span class=\"property\">@render</span> <span class=\"literal\">false</span>\n    other: -&gt;\n      <span class=\"property\">@executeAction</span>(<span class=\"string\">\"index\"</span>)\n\n  controller = TestController.get(<span class=\"string\">\"sharedController\"</span>)\n  controller.dispatch <span class=\"string\">\"other\"</span>\n  deepEqual results, [<span class=\"string\">\"before!\"</span>, <span class=\"string\">\"action!\"</span>, <span class=\"string\">\"after!\"</span>]</code></pre>\n"
  - title: redirect
    tokens: []
    meta: 
      type: function
      level: prototype
      params: "url: string"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: prototype_function_redirect
    html: "<p><code>redirect</code> will forward the user to a new route defined by <code>url</code> without hard-refreshing the page. This modifies the current page URL using pushState if supported, otherwise falling back to hash-bang fragment identifiers. The url can be obtained dynamically using <code>MyApp.get(&#39;routes&#39;).myResourceName().path()</code> or by manually passing a string, such as <code>@redirect(&#39;/test&#39;)</code>.</p>\n"
  - title: scrollToHash
    tokens: []
    meta: 
      type: function
      level: prototype
      params: "[hash: string]"
      returnType: !<tag:yaml.org,2002:js/undefined> ""
    id: prototype_function_scrolltohash
    html: "<p><code>scrollToHash</code> emulates the native scrolling behaviour of the browser by allowing the URL to link to a specific ID on the page. The code will look for an element with a matching ID to <code>hash</code> if it is provided otherwise using the <code>#</code> parameter in the URL. If an element is found, the page will scroll to the matching element.</p>\n"
  - title: autoScrollToHash
    tokens: []
    meta: 
      type: property
      level: prototype
      params: "[= true]"
      returnType: boolean
    id: prototype_property_autoscrolltohash
    html: "<p><code>autoScrollToHash</code> is a boolean property on the instance level of a controller describing whether or not the controller should automatically scroll the browser window to the element with ID equal to the <code>hash</code> parameter. This behaviour emulates the native behaviour of the same nature, but is implemented in Batman so the functionality works after each dispatch (instead of each page refresh) and when Batman is using hash bang routing. <code>autoScrollToHash</code> is true by default.</p>\n"
  - title: defaultRenderYield
    tokens: []
    meta: 
      type: property
      level: prototype
      params: "[= 'main']"
      returnType: string
    id: prototype_property_defaultrenderyield
    html: "<p><code>defaultRenderYield</code> is a <code>string</code> representing which yield a controller should automatically render into if no yield is mentioned explicitly. <code>defaultRenderYield</code> is <code>&#39;main&#39;</code> normally, which means calls to <code>@render()</code> or actions which rely on the implicit rendering render their views into the <code>main</code> yield (and end up wherever <code>data-yield=&quot;main&quot;</code> is found in your HTML).</p>\n"
tokens: []
id: batman.controller
html: "<p><code>Batman.Controller</code> is the base class from which all an application&#39;s controllers should descend from. <code>Batman.Controller</code>s are responsible for executing <em>actions</em> which fire off requests for model data, render views, or redirect to other actions in response to navigation state changes.</p>\n"

---

{{ page.html }}
<ul class="api-list">
{% for s in page.sub %}
  <li class="api-list-item">
    <h3 class="api-title">
      <a id="{{ s.id }}" class="anchor-target"></a>
      <a href="#{{ s.id }}" class="anchor-link">
      <span class="{% if s.meta %}monospace-heading{% endif %}">{% if s.meta.level == 'class' %}@{% endif %}{{ s.title }}{% if s.meta.params %}{% if s.meta.type == 'property' %}<span class="params">{{ s.meta.params }}</span>{% else %}<span class="params">({{ s.meta.params }})</span>  {% endif %}{% endif %}{% if s.meta.returnType %}<span class="return-type">: {{ s.meta.returnType }}</span>{% endif %}</span>
      </a>
    </h3>
    {{ s.html }}
  </li>
{% endfor %}
</ul>
