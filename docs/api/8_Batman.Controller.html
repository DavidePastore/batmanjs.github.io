---
layout: api_docs
title: Batman.Controller
sub: 
  - title: Controller Directory
    tokens: []
    id: 8_0_Controller_Directory
    html: "<p><code>Batman.Controller</code>s are singletons which means each controller in your application is instantiated exactly once. The instance of each controller is available on the class at the <code>@sharedContoller</code> property, or within a <code>ControllerDirectory</code> on the <code>Application</code> class. See <code>Batman.Application.controllers</code>.</p>\n"
  - title: Actions
    tokens: []
    id: 8_1_Actions
    html: "<p>Each <code>Batman.Controller</code> should have a number of instance level functions which can fetch the data needed and often render a view (or views) to display that data. These functions can be declared in typical CoffeeScript fashion like so:</p>\n<p>```coffeescript\nclass Alfred.TodosController</p>\n<p>  index: (params) -&gt;</p>\n<p>  show: (params) -&gt;\n```</p>\n<p>Each action function receives the parameters from the dispatcher which are pulled out of the navigated-to URL. This includes both named route parameters (<code>/:foo</code> style) as well as arbitrary query paramters (<code>?foo=bar</code> style).</p>\n"
  - title: "`routingKey` and Minification"
    tokens: []
    id: "8_2_%60routingKey%60_and_Minification"
    html: "<p>For functionality like contextual redirects and automatic view source and class inference, Batman needs to know the name of all your <code>Controller</code> subclasses. The usual way to do this is by using <code>Function::name</code> which Batman will use in development, but this is often mangled in minified production environments. For this reason, Batman will error out on boot if a <code>Controller</code> subclass&#39; <code>routingKey</code> is not defined on the prototype. The <code>routingKey</code> is a <code>String</code> which remains unmangled after minification and thus allows Batman to continue using the aforementioned features. To disable this requirement (if you know your code won&#39;t ever be minified), set <code>Batman.config.minificationErrors</code> to false.</p>\n"
  - title: "@beforeAction([options : [String|Object]], filter : [String|Function])"
    tokens: []
    id: "8_3_%40beforeAction(%5Boptions_%3A_%5BString%7CObject%5D%5D%2C_filter_%3A_%5BString%7CFunction%5D)"
    html: "<p><code>@beforeAction</code> allows controllers to declare that a function should be executed before the body of an action during action execution. <code>@beforeAction</code> optionally accepts some options representing which action(s) to execute the filter before, and then a string naming a function or function proper to execute.</p>\n<p>The <code>options</code> argument can take three forms to imply different things:</p>\n<ol>\n<li><code>undefined</code>: implies that this filter function should be executed before all actions.</li>\n<li>a String: implies that this filter function should be executed before the action named by the string.</li>\n<li><p>an Object: implies that this filter function should be executed before the actions named by an Array at the <code>only</code> key in the options object, or before all actions excluding those named by an Array at the <code>except</code> key in the options object.</p>\n<p>test &quot;@beforeAction allows declaration of filters to execute before an action&quot;, -&gt;\n  results = []</p>\n<p>  class TestController extends Batman.Controller</p>\n<pre><code>routingKey: <span class=\"string\">'test'</span>\n<span class=\"variable\">@beforeAction</span> only: <span class=\"string\">'index'</span>, -&gt; results.<span class=\"keyword\">push</span> <span class=\"string\">'before!'</span>\n<span class=\"keyword\">index</span>: -&gt;\n  results.<span class=\"keyword\">push</span> <span class=\"string\">'action!'</span>\n  <span class=\"variable\">@render</span> false</code></pre>\n<p>  controller = TestController.get(&#39;sharedController&#39;)\n  controller.dispatch &#39;index&#39;\n  equal results[0], &#39;before!&#39;\n  equal results[1], &#39;action!&#39;</p>\n<p>test &quot;@beforeAction allows declaration of named filters to execute before an action&quot;, -&gt;\n  class TodoController extends Batman.Controller</p>\n<pre><code><span class=\"method\">routingKey:</span> <span class=\"string\">'test'</span>\n@beforeAction <span class=\"method\">only:</span> <span class=\"string\">'show'</span>, <span class=\"string\">'fetchTodo'</span>\n<span class=\"method\">fetchTodo:</span> -&gt; @set <span class=\"string\">'todo'</span>, {<span class=\"method\">isDone:</span> <span class=\"keyword\">true</span>}\n<span class=\"method\">show:</span> -&gt;\n  @render <span class=\"keyword\">false</span></code></pre>\n<p>  controller = TodoController.get(&#39;sharedController&#39;)\n  controller.dispatch &#39;show&#39;\n  deepEqual controller.get(&#39;todo&#39;), {isDone: true}</p>\n<p>test &quot;@beforeAction allows whitelisting or blacklisting filters to execute before an action&quot;, -&gt;\n  class TodoController extends Batman.Controller</p>\n<pre><code><span class=\"method\">routingKey:</span> <span class=\"string\">'test'</span>\n@beforeAction <span class=\"method\">only:</span> [<span class=\"string\">'show'</span>, <span class=\"string\">'edit'</span>], <span class=\"string\">'fetchTodo'</span>\n@beforeAction <span class=\"method\">except:</span> [<span class=\"string\">'index'</span>], <span class=\"string\">'prepareNewTodo'</span>\n<span class=\"method\">fetchTodo:</span> -&gt; @set <span class=\"string\">'todo'</span>, {<span class=\"method\">isDone:</span> <span class=\"keyword\">true</span>}\n<span class=\"method\">prepareNewTodo:</span> -&gt; @set <span class=\"string\">'newTodo'</span>, {<span class=\"method\">isDone:</span> <span class=\"keyword\">false</span>}\n<span class=\"method\">index:</span> -&gt; @render <span class=\"keyword\">false</span>\n<span class=\"method\">show:</span> -&gt; @render <span class=\"keyword\">false</span></code></pre>\n<p>  controller = TodoController.get(&#39;sharedController&#39;)\n  controller.dispatch &#39;show&#39;\n  deepEqual controller.get(&#39;todo&#39;), {isDone: true}\n  deepEqual controller.get(&#39;newTodo&#39;), {isDone: false}</p>\n<p>test &quot;@beforeAction allows declaration of filters to execute before all actions&quot;, -&gt;\n  results = []</p>\n<p>  class TestController extends Batman.Controller</p>\n<pre><code>routingKey: <span class=\"string\">'test'</span>\n<span class=\"variable\">@beforeAction</span> -&gt; results.<span class=\"keyword\">push</span> <span class=\"string\">'before!'</span>\n<span class=\"keyword\">index</span>: -&gt;\n  results.<span class=\"keyword\">push</span> <span class=\"string\">'action!'</span>\n  <span class=\"variable\">@render</span> false</code></pre>\n<p>  controller = TestController.get(&#39;sharedController&#39;)\n  controller.dispatch &#39;index&#39;\n  equal results[0], &#39;before!&#39;\n  equal results[1], &#39;action!&#39;</p>\n</li>\n</ol>\n"
  - title: "@afterAction([options : [String|Object]], filter : [String|Function])"
    tokens: []
    id: "8_4_%40afterAction(%5Boptions_%3A_%5BString%7CObject%5D%5D%2C_filter_%3A_%5BString%7CFunction%5D)"
    html: "<p><code>@afterAction</code> allows controllers to declare that a function should be run after the action body and all operations have completed during action execution. Functions declared by <code>@afterAction</code> will thus be run after the code of the action body and also after any redirects or renders have taken place and completed. <code>@beforeAction</code> optionally accepts some options representing which action(s) to execute the filter before, and then a string naming a function or function proper to execute. See <code>Batman.Controller.beforeAction</code> for documentation on the structure of the options.</p>\n<pre><code>test <span class=\"string\">\"@afterAction allows declaration of filters to execute before an action\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span>\n    <span class=\"title\">routingKey</span>: '<span class=\"title\">test</span>'\n    @<span class=\"title\">afterAction</span> <span class=\"title\">only</span>: '<span class=\"title\">index</span>', -&gt; <span class=\"title\">results</span>.<span class=\"title\">push</span> '<span class=\"title\">after</span>!'\n    <span class=\"title\">index</span>: -&gt;\n      <span class=\"title\">results</span>.<span class=\"title\">push</span> '<span class=\"title\">action</span>!'\n      @<span class=\"title\">render</span> <span class=\"title\">false</span>\n\n  <span class=\"title\">controller</span> = <span class=\"title\">TestController</span>.<span class=\"title\">get</span>('<span class=\"title\">sharedController</span>')\n  <span class=\"title\">controller</span>.<span class=\"title\">dispatch</span> '<span class=\"title\">index</span>'\n  <span class=\"title\">equal</span> <span class=\"title\">results</span>[0], '<span class=\"title\">action</span>!'\n  <span class=\"title\">equal</span> <span class=\"title\">results</span>[1], '<span class=\"title\">after</span>!'\n\n<span class=\"title\">test</span> \"@<span class=\"title\">afterAction</span> <span class=\"title\">allows</span> <span class=\"title\">declaration</span> <span class=\"title\">of</span> <span class=\"title\">named</span> <span class=\"title\">filters</span> <span class=\"title\">to</span> <span class=\"title\">execute</span> <span class=\"title\">before</span> <span class=\"title\">an</span> <span class=\"title\">action</span>\", -&gt;\n  <span class=\"title\">result</span> = <span class=\"title\">null</span>\n\n  <span class=\"title\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span>\n    <span class=\"title\">routingKey</span>: '<span class=\"title\">test</span>'\n    @<span class=\"title\">afterAction</span> <span class=\"title\">only</span>: '<span class=\"title\">create</span>', '<span class=\"title\">notify</span>'\n    <span class=\"title\">create</span>: -&gt; @<span class=\"title\">render</span> <span class=\"title\">false</span>\n    <span class=\"title\">notify</span>: -&gt; <span class=\"title\">result</span> = \"<span class=\"title\">Todo</span> <span class=\"title\">created</span> <span class=\"title\">successfully</span>.\"\n\n  <span class=\"title\">controller</span> = <span class=\"title\">TodoController</span>.<span class=\"title\">get</span>('<span class=\"title\">sharedController</span>')\n  <span class=\"title\">controller</span>.<span class=\"title\">dispatch</span> '<span class=\"title\">create</span>'\n  <span class=\"title\">equal</span> <span class=\"title\">result</span>, '<span class=\"title\">Todo</span> <span class=\"title\">created</span> <span class=\"title\">successfully</span>.'\n\n<span class=\"title\">test</span> \"@<span class=\"title\">afterAction</span> <span class=\"title\">allows</span> <span class=\"title\">whitelisting</span> <span class=\"title\">or</span> <span class=\"title\">blacklisting</span> <span class=\"title\">filters</span> <span class=\"title\">to</span> <span class=\"title\">execute</span> <span class=\"title\">before</span> <span class=\"title\">an</span> <span class=\"title\">action</span>\", -&gt;\n  <span class=\"title\">result</span> = <span class=\"title\">null</span>\n\n  <span class=\"title\">class</span> <span class=\"title\">TodoController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span>\n    <span class=\"title\">routingKey</span>: '<span class=\"title\">test</span>'\n    @<span class=\"title\">afterAction</span> {</span>only: [<span class=\"string\">'create'</span>, <span class=\"string\">'update'</span>]}, <span class=\"string\">'notify'</span>\n    index: -&gt; @render <span class=\"literal\">false</span>\n    create: -&gt; @render <span class=\"literal\">false</span>\n    notify: -&gt; result = <span class=\"string\">\"Todo created successfully.\"</span>\n\n  controller = TodoController.<span class=\"keyword\">get</span>(<span class=\"string\">'sharedController'</span>)\n  controller.dispatch <span class=\"string\">'index'</span>\n  equal result, <span class=\"literal\">null</span>\n  controller.dispatch <span class=\"string\">'create'</span>\n  equal result, <span class=\"string\">'Todo created successfully.'</span>\n\ntest <span class=\"string\">\"@afterAction allows declaration of filters to execute before all actions\"</span>, -&gt;\n  results = []\n\n  <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TestController</span> <span class=\"keyword\">extends</span> <span class=\"title\">Batman</span>.<span class=\"title\">Controller</span>\n    <span class=\"title\">routingKey</span>: '<span class=\"title\">test</span>'\n    @<span class=\"title\">afterAction</span> -&gt; <span class=\"title\">results</span>.<span class=\"title\">push</span> '<span class=\"title\">after</span>!'\n    <span class=\"title\">index</span>: -&gt;\n      <span class=\"title\">results</span>.<span class=\"title\">push</span> '<span class=\"title\">action</span>!'\n      @<span class=\"title\">render</span> <span class=\"title\">false</span>\n\n  <span class=\"title\">controller</span> = <span class=\"title\">TestController</span>.<span class=\"title\">get</span>('<span class=\"title\">sharedController</span>')\n  <span class=\"title\">controller</span>.<span class=\"title\">dispatch</span> '<span class=\"title\">index</span>'\n  <span class=\"title\">equal</span> <span class=\"title\">results</span>[0], '<span class=\"title\">action</span>!'\n  <span class=\"title\">equal</span> <span class=\"title\">results</span>[1], '<span class=\"title\">after</span>!'</code></pre>\n"
  - title: "autoScrollToHash[= true] : boolean"
    tokens: []
    id: "8_5_autoScrollToHash%5B%3D_true%5D_%3A_boolean"
    html: "<p><code>autoScrollToHash</code> is a boolean property on the instance level of a controller describing whether or not the controller should automatically scroll the browser window to the element with ID equal to the <code>hash</code> parameter. This behaviour emulates the native behaviour of the same nature, but is implemented in Batman so the functionality works after each dispatch (instead of each page refresh) and when Batman is using hash bang routing. <code>autoScrollToHash</code> is true by default.</p>\n"
  - title: "defaultRenderYield[= 'main'] : String"
    tokens: []
    id: "8_6_defaultRenderYield%5B%3D_'main'%5D_%3A_String"
    html: "<p><code>defaultRenderYield</code> is a <code>String</code> representing which yield a controller should automatically render into if no yield is mentioned explicitly. <code>defaultRenderYield</code> is <code>&#39;main&#39;</code> normally, which means calls to <code>@render()</code> or actions which rely on the implicit rendering render their views into the <code>main</code> yield (and end up wherever <code>data-yield=&quot;main&quot;</code> is found in your HTML).</p>\n"
  - title: Controller Actions
    tokens: []
    id: 8_7_Controller_Actions
    html: ""
  - title: executeAction
    tokens: []
    id: 8_8_executeAction
    html: ""
  - title: render
    tokens: []
    id: 8_9_render
    html: ""
  - title: redirect
    tokens: []
    id: 8_10_redirect
    html: ""
  - title: scrollToHash
    tokens: []
    id: 8_11_scrollToHash
    html: ""
tokens: []
id: 8_Batman.Controller
html: "<p><code>Batman.Controller</code> is the base class from which all an application&#39;s controllers should descend from. <code>Batman.Controllers</code> are responsible for executing <em>actions</em> which fire off requests for model data, render views, or redirect to other actions in response to navigation state changes.</p>\n"

---

{{ page.html }}
{% for s in page.sub %}
  <h3 id="{{ s.id }}">{{ s.title }}</h3>
  {{ s.html }}
{% endfor %}
